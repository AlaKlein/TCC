---
  - name: MariaDB auto-install
    hosts: all
    become: yes
    become_user: root
    tasks:
      - name: Enable EPEL Repository on CentOS 7
        yum:
          name: epel-release
          state: latest

      #- name: upgrade all packages
      #  yum: name=* state=latest
      - name: install updates
        yum: update_cache=yes

      - name: Install MariaDB
        yum:
          name: 
          - mariadb-server
          - python3-PyMySQL
          state: latest

      - name: Start MariaDB
        service:
          name: mariadb
          enabled: true
          state: started

      - name: Install Java
        yum: 
          name: java-11-openjdk-devel 
          state: present

      - name: download tomcat server packages
        get_url:
          url: https://archive.apache.org/dist/tomcat/tomcat-10/v10.0.21/bin/apache-tomcat-10.0.21.tar.gz
          dest: /usr/local

      - name: extract tomcat packages
        unarchive:
          src: /usr/local/apache-tomcat-10.0.21.tar.gz
          dest: /usr/local
          remote_src: yes

      - name: Install git
        yum:
          name: git
          state: present
          update_cache: yes

      - name: Clone a github repository
        git:
          repo: https://github.com/AlaKlein/Help-Desk.git
          dest: /usr/local/git
          clone: yes
          update: yes

      - name: copy src.txt as dest.txt in the same dir 
        copy:
          src: /usr/local/git/src/main/webapp/
          dest: /usr/local/apache-tomcat-10.0.21/webapps/ROOT
          remote_src: yes
        tags:
          - simple_copy

      - name: start tomcat services
        shell: nohup /usr/local/apache-tomcat-10.0.21/bin/startup.sh